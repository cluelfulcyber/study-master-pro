# LimbusMentor - Local Setup Guide

Complete guide to run LimbusMentor locally with Python backend and PostgreSQL database.

## Prerequisites

- **Python 3.10+** - [Download](https://www.python.org/downloads/)
- **PostgreSQL 15+** - [Download](https://www.postgresql.org/download/)
- **Node.js 18+** - [Download](https://nodejs.org/)
- **OpenAI API Key** - [Get one here](https://platform.openai.com/api-keys)

## Setup Instructions

### 1. Database Setup

#### macOS
```bash
brew install postgresql@15
brew services start postgresql@15
psql postgres
```

#### Ubuntu/Debian
```bash
sudo apt update
sudo apt install postgresql postgresql-contrib
sudo systemctl start postgresql
sudo -u postgres psql
```

#### Windows
Download and install from https://www.postgresql.org/download/windows/

#### Create Database
```sql
CREATE DATABASE limbus_mentor;
\q
```

### 2. Backend Setup

```bash
cd backend

# Create virtual environment
python -m venv venv

# Activate virtual environment
# macOS/Linux:
source venv/bin/activate
# Windows:
venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt

# Create .env file
cp .env.example .env
```

Edit `backend/.env` and add your configuration:
```env
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/limbus_mentor
JWT_SECRET_KEY=your-super-secret-key-change-this
OPENAI_API_KEY=sk-your-openai-api-key-here
```

**Important:** 
- Replace `postgres:postgres` with your PostgreSQL username and password
- Generate a secure JWT_SECRET_KEY (use a random 32+ character string)
- Add your OpenAI API key

### 3. Frontend Setup

```bash
# From project root
npm install

# Create .env.local file
echo "VITE_API_URL=http://localhost:8000" > .env.local
```

### 4. Running the Application

#### Terminal 1 - Backend
```bash
cd backend
source venv/bin/activate  # or venv\Scripts\activate on Windows
python main.py
```

Backend will run on http://localhost:8000
- API Documentation: http://localhost:8000/docs
- Alternative docs: http://localhost:8000/redoc

#### Terminal 2 - Frontend
```bash
# From project root
npm run dev
```

Frontend will run on http://localhost:8080

## Database Schema

The backend automatically creates these tables on first run:
- `users` - User authentication and accounts
- `profiles` - Extended user profile information
- `study_sessions` - Study summaries generated by AI
- `quiz_results` - Quiz scores and performance data

## API Endpoints

### Authentication
- `POST /auth/signup` - Create new account
- `POST /auth/login` - Login
- `POST /auth/logout` - Logout
- `GET /auth/user` - Get current user

### Study Sessions
- `POST /generate-summary` - Generate AI study summary
- `POST /generate-quiz` - Generate quiz questions
- `GET /study-sessions` - Get user's study sessions
- `DELETE /study-sessions/{id}` - Delete a session

### Quiz Results
- `POST /quiz-results` - Save quiz result
- `GET /quiz-results` - Get user's quiz history

## Troubleshooting

### Backend Issues

**"ModuleNotFoundError"**
```bash
# Make sure virtual environment is activated
source venv/bin/activate  # or venv\Scripts\activate
pip install -r requirements.txt
```

**"Connection to database failed"**
- Verify PostgreSQL is running: `pg_isready`
- Check DATABASE_URL in backend/.env
- Ensure database exists: `psql -l`

**"Invalid OpenAI API key"**
- Verify your OPENAI_API_KEY in backend/.env
- Ensure it starts with `sk-`
- Check your API key at https://platform.openai.com/api-keys

### Frontend Issues

**"Failed to fetch" or CORS errors**
- Ensure backend is running on http://localhost:8000
- Check VITE_API_URL in .env.local
- Clear browser cache and refresh

**"401 Unauthorized"**
- Token might be expired - sign out and sign in again
- Check backend logs for authentication errors

### Database Issues

**Reset the database**
```bash
# Connect to PostgreSQL
psql postgres

# Drop and recreate database
DROP DATABASE limbus_mentor;
CREATE DATABASE limbus_mentor;
\q

# Restart backend - tables will be auto-created
```

## Development Tips

### Backend Development
- Hot reload is not enabled by default
- Restart backend server after code changes
- Check logs in terminal for debugging
- Use `/docs` endpoint to test APIs

### Frontend Development
- Vite provides hot module replacement
- Changes reflect immediately
- Check browser console for errors
- Use React DevTools for component debugging

### Database Management

**View data with psql:**
```bash
psql limbus_mentor

-- See all tables
\dt

-- Query users
SELECT * FROM users;

-- Query study sessions
SELECT * FROM study_sessions;

-- Exit
\q
```

**GUI Tools:**
- [pgAdmin](https://www.pgadmin.org/) - Full-featured PostgreSQL client
- [DBeaver](https://dbeaver.io/) - Universal database tool
- [TablePlus](https://tableplus.com/) - Modern database GUI

## Project Structure

```
.
├── backend/                 # Python FastAPI backend
│   ├── main.py             # Main API application
│   ├── models.py           # SQLAlchemy models
│   ├── schemas.py          # Pydantic schemas
│   ├── database.py         # Database connection
│   ├── auth.py             # Authentication logic
│   ├── ai_service.py       # OpenAI integration
│   └── requirements.txt    # Python dependencies
│
├── src/                    # React frontend
│   ├── lib/api.ts          # API client
│   ├── contexts/           # React contexts
│   ├── pages/              # Page components
│   └── components/         # UI components
│
└── .env.local              # Frontend environment variables
```

## Environment Variables

### Backend (.env in backend/)
- `DATABASE_URL` - PostgreSQL connection string
- `JWT_SECRET_KEY` - Secret key for JWT tokens
- `OPENAI_API_KEY` - OpenAI API key for AI features

### Frontend (.env.local in root)
- `VITE_API_URL` - Backend API URL (default: http://localhost:8000)

## Production Deployment

For production deployment, you'll need to:

1. **Backend:**
   - Use a production WSGI server (e.g., Gunicorn + Uvicorn workers)
   - Set up a production PostgreSQL database
   - Use environment variables for secrets
   - Enable HTTPS
   - Set proper CORS origins

2. **Frontend:**
   - Build for production: `npm run build`
   - Serve static files with a web server (Nginx, Apache)
   - Update VITE_API_URL to production backend URL

3. **Database:**
   - Set up automated backups
   - Use connection pooling
   - Monitor performance
   - Regular maintenance

## Support

For issues or questions:
1. Check this guide thoroughly
2. Review backend logs in terminal
3. Check browser console for frontend errors
4. Verify all environment variables are set correctly

## License

This project is for educational purposes.
